{% extends "dashboard.html" %}

{% block title %}Empleados Inactivos{% endblock %}
{% block container_class %}justify-content-start align-items-start{% endblock %}

{% block content %}
<h5 class="d-flex justify-content-center align-items-center mb-3 fw-bold text-center">Gestión de Empleados Inactivos</h5>

<!-- Tabla -->
<div class="card shadow-sm border-0 rounded-3">
    <div class="card-body p-3">
        <div class="table-responsive-md">
            <table class="table table-striped table-hover table-borderless align-middle text-center w-100" id="InactiveEmployeesTable">
                <thead class="table-dark border-bottom border-2 fw-semibold">
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">NOMBRE COMPLETO</th>
                        <th scope="col">DOCUMENTO</th>
                        <th scope="col">CARGO</th>
                        <th scope="col">CORREO INSTITUCIONAL</th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                <!-- DataTables -->
            </table>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        initDataTable("#InactiveEmployeesTable", {
            ajax: {
                url: "/api/empleados/",
                dataSrc: function (json) {
                    return json.filter(emp => !emp.activo);
                }
            },
            columns: [
                { data: null, render: (d,t,r,m) => m.row + 1 },
                { data: "nombre_completo", render: (data) => data ? data.toUpperCase() : "-" },
                {
                    data: "documento",
                    render: function (data, type, row) {
                        if (!data) return "-";
                        let sides = data.split(" - ");
                        let typeSide = sides[0];
                        let formattedNumberDocument = sides[1];
                        let numberDocument = formattedNumberDocument.replace(/\./g, "");
                        if (type === 'filter' || type === 'sort') {
                            return `${typeSide} - ${numberDocument}`;
                        }
                        return data;
                    }
                },
                { data: "cargo", render: (data) => data ? data.toUpperCase() : "-" },
                { data: "correo_institucional", render: (data) => data ? data : "-" },
                { data: null, orderable: false, render: () => `
                    <div class="dropdown">
                        <a class="text-secondary-emphasis" type="button" data-bs-toggle="dropdown">
                            <i class="bi bi-three-dots-vertical"></i>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end shadow-sm">
                            <li><a class="dropdown-item" href="#"><i class="bi bi-envelope me-2"></i>Correo Institucional</a></li>
                            <li><a class="dropdown-item" href="#"><i class="bi bi-qr-code me-2"></i>Generar Código QR</a></li>
                        </ul>
                    </div>
                `}
            ]
        });
    });
</script>
{% endblock %}
